<!DOCTYPE html>
<!-- saved from url=(0039)http://josh.github.com/rails-behaviors/ -->
<html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
  <meta charset="utf-8">
  <title>Rails Behaviors</title>
  <link rel="stylesheet" href="http://josh.github.com/rails-behaviors/styles.css">
</head>
<body>
  <section class="sidebar">
    <ul>
      <li><a href="http://josh.github.com/rails-behaviors/#remote">Remote</a></li>
      <li><a href="http://josh.github.com/rails-behaviors/#method">Method</a></li>
      <li><a href="http://josh.github.com/rails-behaviors/#confirm">Confirm</a></li>
      <li><a href="http://josh.github.com/rails-behaviors/#disable">Disable</a></li>
      <li><a href="http://josh.github.com/rails-behaviors/#accept">Accept</a></li>
      <li><a href="http://josh.github.com/rails-behaviors/#csrf">CSRF</a></li>
    </ul>
  </section>

  <section class="content">
    <h1>Rails Behaviors</h1>

    <p>Rails Behaviors implements the <code>data-*</code> behaviors generated by Rails 3.x.</p>

    <p>See more about setup and installation steps at <a href="https://github.com/josh/rails-behaviors">https://github.com/josh/rails-behaviors</a>.</p>

    
<h2 id="remote">Remote</h2>

<p><code>#= require rails/remote</code></p>

<p>Implements <code>data-remote</code> for forms and links.</p>

<h3>Markup</h3>

<p><code>&lt;a&gt;</code></p>
<table>
  <thead>
    <tr><th><p>Attribute</p></th>
    <th><p>Description</p></th>
  </tr></thead>
  <tbody>
<tr>
<td><p><code>data-remote</code></p>
</td>
<td><p>Enables remote behavior on the element if set to anything.</p>
</td>
</tr>
<tr>
<td><p><code>data-method</code></p>
</td>
<td><p>Changes the method of the AJAX request. Defaults to <code>"get"</code>. Maps to
jQuery's <a href="http://api.jquery.com/jQuery.ajax/">type</a>.</p>
</td>
</tr>
<tr>
<td><p><code>href</code></p>
</td>
<td><p>URL for AJAX request. Defaults to the current url. Maps to jQuery's
<a href="http://api.jquery.com/jQuery.ajax/"><code>url</code></a>.</p>
</td>
</tr>
<tr>
<td><p><code>data-type</code></p>
</td>
<td><p>Specify the data type of the response. Can be <code>"xml"</code>, <code>"json"</code>,
<code>"script"</code>, or <code>"html"</code>. Defaults to jQuery's <em>"intelligent guess"</em>
from the response content type. Maps to jQuery's
<a href="http://api.jquery.com/jQuery.ajax/"><code>dataType</code></a>.</p>
</td>
</tr>
  </tbody>
</table><div class="highlight"><pre><span class="nt">&lt;a</span> <span class="na">href=</span><span class="s">"/toggle"</span> <span class="na">data-method=</span><span class="s">"post"</span> <span class="na">data-remote</span><span class="nt">&gt;</span>Toggle<span class="nt">&lt;/a&gt;</span>
</pre>
</div>

<p><code>&lt;form&gt;</code></p>
<table>
  <thead>
    <tr><th><p>Attribute</p></th>
    <th><p>Description</p></th>
  </tr></thead>
  <tbody>
<tr>
<td><p><code>data-remote</code></p>
</td>
<td><p>Enables remote behavior on the element if set to anything.</p>
</td>
</tr>
<tr>
<td><p><code>method</code></p>
</td>
<td><p>Changes the method of the AJAX request. Defaults to <code>"get"</code>. Maps to
jQuery's <a href="http://api.jquery.com/jQuery.ajax/">type</a>.</p>
</td>
</tr>
<tr>
<td><p><code>action</code></p>
</td>
<td><p>URL for AJAX request. Defaults to the current url. Maps to jQuery's
<a href="http://api.jquery.com/jQuery.ajax/"><code>url</code></a>.</p>
</td>
</tr>
<tr>
<td><p><code>data-type</code></p>
</td>
<td><p>Specify the data type of the response. Can be <code>"xml"</code>, <code>"json"</code>,
<code>"script"</code>, or <code>"html"</code>. Defaults to jQuery's <em>"intelligent guess"</em>
from the response content type. Maps to jQuery's
<a href="http://api.jquery.com/jQuery.ajax/"><code>dataType</code></a>.</p>
</td>
</tr>
  </tbody>
</table><div class="highlight"><pre><span class="nt">&lt;form</span> <span class="na">action=</span><span class="s">"/comment"</span> <span class="na">method=</span><span class="s">"post"</span> <span class="na">data-remote</span><span class="nt">&gt;&lt;/form&gt;</span>
</pre>
</div>

<h3>Events</h3>

<p>Use delegated jQuery's global AJAX events to handle successful
and error states. See jQuery's <a href="http://docs.jquery.com/Ajax_Events">AJAX event
documentation</a> for a complete
reference.</p>

<p><code>ajaxBeforeSend</code></p>

<p>This event, which is triggered before an Ajax request is started, allows you to modify the XMLHttpRequest object (setting additional headers, if need be.)</p>
<table>
  <thead>
    <tr><th><p>Property</p></th>
    <th><p>Value</p></th>
  </tr></thead>
  <tbody>
<tr>
<td><p>Synchronicity </p>
</td>
<td><p>Sync</p>
</td>
</tr>
<tr>
<td><p>Bubbles       </p>
</td>
<td><p>Yes</p>
</td>
</tr>
<tr>
<td><p>Cancelable    </p>
</td>
<td><p>Yes</p>
</td>
</tr>
<tr>
<td><p>Default action</p>
</td>
<td><p>Sends request</p>
</td>
</tr>
<tr>
<td><p>Target        </p>
</td>
<td><p><code>a</code> or <code>form</code> element with <code>[data-remote]</code></p>
</td>
</tr>
<tr>
<td><p>Extra arguments</p>
</td>
<td><table>
  <tbody>
<tr>
<td><p><a href="http://api.jquery.com/jQuery.ajax/#jqXHR"><code>jqXHR</code></a></p>
</td>
<td><p>XMLHttpRequest like object</p>
</td>
</tr>
<tr>
<td><p><a href="http://api.jquery.com/jQuery.ajax/#jQuery-ajax-settings"><code>settings</code></a></p>
</td>
<td><p>Object passed as <code>$.ajax</code> settings</p>
</td>
</tr>
  </tbody>
</table></td>
</tr>
  </tbody>
</table>
<p><code>ajaxSuccess</code></p>

<p>This event is only called if the request was successful (no errors from the server, no errors with the data).</p>
<table>
  <thead>
    <tr><th><p>Property</p></th>
    <th><p>Value</p></th>
  </tr></thead>
  <tbody>
<tr>
<td><p>Synchronicity </p>
</td>
<td><p>Sync</p>
</td>
</tr>
<tr>
<td><p>Bubbles       </p>
</td>
<td><p>Yes</p>
</td>
</tr>
<tr>
<td><p>Cancelable    </p>
</td>
<td><p>No</p>
</td>
</tr>
<tr>
<td><p>Target        </p>
</td>
<td><p><code>a</code> or <code>form</code> element with <code>[data-remote]</code></p>
</td>
</tr>
<tr>
<td><p>Extra arguments</p>
</td>
<td><table>
  <tbody>
<tr>
<td><p><a href="http://api.jquery.com/jQuery.ajax/#jqXHR"><code>jqXHR</code></a></p>
</td>
<td><p>XMLHttpRequest like object</p>
</td>
</tr>
<tr>
<td><p><a href="http://api.jquery.com/jQuery.ajax/#jQuery-ajax-settings"><code>settings</code></a></p>
</td>
<td><p>Object passed as <code>$.ajax</code> settings</p>
</td>
</tr>
<tr>
<td><p><code>data</code></p>
</td>
<td><p>The data returned from the server</p>
</td>
</tr>
  </tbody>
</table></td>
</tr>
  </tbody>
</table>
<p><code>ajaxError</code></p>

<p>This event is only called if an error occurred with the request (you can never have both an error and a success callback with a request).</p>
<table>
  <thead>
    <tr><th><p>Property</p></th>
    <th><p>Value</p></th>
  </tr></thead>
  <tbody>
<tr>
<td><p>Synchronicity </p>
</td>
<td><p>Sync</p>
</td>
</tr>
<tr>
<td><p>Bubbles       </p>
</td>
<td><p>Yes</p>
</td>
</tr>
<tr>
<td><p>Cancelable    </p>
</td>
<td><p>No</p>
</td>
</tr>
<tr>
<td><p>Target        </p>
</td>
<td><p><code>a</code> or <code>form</code> element with <code>[data-remote]</code></p>
</td>
</tr>
<tr>
<td><p>Extra arguments</p>
</td>
<td><table>
  <tbody>
<tr>
<td><p><a href="http://api.jquery.com/jQuery.ajax/#jqXHR"><code>jqXHR</code></a></p>
</td>
<td><p>XMLHttpRequest like object</p>
</td>
</tr>
<tr>
<td><p><code>textStatus</code></p>
</td>
<td><p><code>"timeout"</code>, <code>"error"</code>, <code>"abort"</code>, or <code>"parsererror"</code></p>
</td>
</tr>
<tr>
<td><p><code>errorThrown</code></p>
</td>
<td><p>Exception object</p>
</td>
</tr>
  </tbody>
</table></td>
</tr>
  </tbody>
</table>
<p><code>ajaxComplete</code></p>

<p>This event is called regardless of if the request was successful, or not. You will always receive a complete callback, even for synchronous requests.</p>
<table>
  <thead>
    <tr><th><p>Property</p></th>
    <th><p>Value</p></th>
  </tr></thead>
  <tbody>
<tr>
<td><p>Synchronicity </p>
</td>
<td><p>Sync</p>
</td>
</tr>
<tr>
<td><p>Bubbles       </p>
</td>
<td><p>Yes</p>
</td>
</tr>
<tr>
<td><p>Cancelable    </p>
</td>
<td><p>No</p>
</td>
</tr>
<tr>
<td><p>Target        </p>
</td>
<td><p><code>a</code> or <code>form</code> element with <code>[data-remote]</code></p>
</td>
</tr>
<tr>
<td><p>Extra arguments</p>
</td>
<td><table>
  <tbody>
<tr>
<td><p><a href="http://api.jquery.com/jQuery.ajax/#jqXHR"><code>jqXHR</code></a></p>
</td>
<td><p>XMLHttpRequest like object</p>
</td>
</tr>
<tr>
<td><p><code>textStatus</code></p>
</td>
<td><p><code>"timeout"</code>, <code>"error"</code>, <code>"abort"</code>, or <code>"parsererror"</code></p>
</td>
</tr>
  </tbody>
</table></td>
</tr>
  </tbody>
</table><div class="highlight"><pre>$<span class="p">(</span><span class="n">document</span><span class="p">).</span><span class="n">on</span> <span class="s">'ajaxBeforeSend'</span><span class="p">,</span> <span class="s">'.new-comment'</span><span class="p">,</span> <span class="o">-&gt;</span>
   $<span class="p">(</span><span class="n">this</span><span class="p">).</span><span class="n">addClass</span> <span class="s">'loading'</span>

$<span class="p">(</span><span class="n">document</span><span class="p">).</span><span class="n">on</span> <span class="s">'ajaxComplete'</span><span class="p">,</span> <span class="s">'.new-comment'</span><span class="p">,</span> <span class="o">-&gt;</span>
   $<span class="p">(</span><span class="n">this</span><span class="p">).</span><span class="n">removeClass</span> <span class="s">'loading'</span>

$<span class="p">(</span><span class="n">document</span><span class="p">).</span><span class="n">on</span> <span class="s">'ajaxSuccess'</span><span class="p">,</span> <span class="s">'.new-comment'</span><span class="p">,</span> <span class="p">(</span><span class="n">event</span><span class="p">,</span> <span class="n">xhr</span><span class="p">,</span> <span class="n">settings</span><span class="p">,</span> <span class="n">data</span><span class="p">)</span> <span class="o">-&gt;</span>
  $<span class="p">(</span><span class="s">'.comments'</span><span class="p">).</span><span class="n">append</span> <span class="n">data</span><span class="p">.</span><span class="n">commentHTML</span>

$<span class="p">(</span><span class="n">document</span><span class="p">).</span><span class="n">on</span> <span class="s">'ajaxError'</span><span class="p">,</span> <span class="s">'.new-comment'</span><span class="p">,</span> <span class="o">-&gt;</span>
  <span class="n">alert</span> "<span class="n">Something</span> <span class="n">went</span> <span class="n">wrong</span>!"
</pre>
</div>

    
<h2 id="method">Method</h2>

<p><code>#= require rails/method</code></p>

<p>Allow links to be followed with an alternate method
using <code>data-method</code>.</p>

<p>To fake this, a hidden form element is created on the fly
and is submitted.</p>

<h3>Markup</h3>

<p><code>&lt;a&gt;</code></p>
<table>
  <thead>
    <tr><th><p>Attribute</p></th>
    <th><p>Description</p></th>
  </tr></thead>
  <tbody>
<tr>
<td><p><code>data-method</code></p>
</td>
<td><p>Method for following <code>href</code>. Can be <code>"post"</code>, <code>"put"</code>, or
<code>"delete"</code>. <code>"get"</code> is ignored since its the default behavior for
links.</p>
</td>
</tr>
  </tbody>
</table><div class="highlight"><pre><span class="nt">&lt;a</span> <span class="na">href=</span><span class="s">"/posts/1"</span> <span class="na">data-method=</span><span class="s">"delete"</span><span class="nt">&gt;</span>Delete<span class="nt">&lt;/a&gt;</span>
</pre>
</div>

    
<h2 id="confirm">Confirm</h2>

<p><code>#= require rails/confirm</code></p>

<p>Prompts native confirm dialog before activating link.</p>

<h3>Markup</h3>

<p><code>&lt;a&gt;</code></p>
<table>
  <thead>
    <tr><th><p>Attribute</p></th>
    <th><p>Description</p></th>
  </tr></thead>
  <tbody>
<tr>
<td><p><code>data-confirm</code></p>
</td>
<td><p>Message to pass to <code>confirm()</code>.</p>
</td>
</tr>
  </tbody>
</table><div class="highlight"><pre><span class="nt">&lt;a</span> <span class="na">href=</span><span class="s">"/"</span> <span class="na">data-confirm=</span><span class="s">"Are you sure?"</span><span class="nt">&gt;</span>Delete<span class="nt">&lt;/a&gt;</span>
</pre>
</div>

    
<h2 id="disable">Disable</h2>

<p><code>#= require rails/disable</code></p>

<p>Disables clicked buttons with text in <code>data-disable-with</code>.</p>

<h3>Markup</h3>

<p><code>&lt;input type=submit&gt;</code> or <code>&lt;button type=submit&gt;</code></p>
<table>
  <thead>
    <tr><th><p>Attribute</p></th>
    <th><p>Description</p></th>
  </tr></thead>
  <tbody>
<tr>
<td><p><code>data-disable-with</code></p>
</td>
<td><p>Message to set <code>&lt;input&gt;</code> value or <code>&lt;button&gt;</code> innerHTML to.</p>
</td>
</tr>
  </tbody>
</table><div class="highlight"><pre><span class="o">&lt;</span><span class="n">input</span> <span class="n">type</span><span class="p">=</span>"<span class="n">submit</span>" <span class="n">data</span><span class="o">-</span><span class="n">disable</span><span class="o">-</span><span class="n">with</span><span class="p">=</span>"<span class="n">Submitting</span><span class="p">...</span>"<span class="o">&gt;</span>
</pre>
</div>

    
<h2 id="accept">Accept</h2>

<p><code>#= require rails/accept</code></p>

<p>Make default Accept header prefer JS.</p>

<p>jQuery's default Accept header is just <code>"*/*"</code>, which means accept
anything back. To make AJAX requests work nicer with Rails'
<code>respond_to</code> block, this prioritizes JS responds over others.</p>

<p>For an example:</p>
<div class="highlight"><pre><span class="n">respond_to</span> <span class="n">do</span> <span class="o">|</span><span class="n">format</span><span class="o">|</span>
  <span class="n">format</span><span class="p">.</span><span class="n">html</span>
  <span class="n">format</span><span class="p">.</span><span class="n">js</span>
<span class="k">end</span>
</pre>
</div>

<p>Would return <code>html</code> for <code>"*/*"</code> just because its first in the list.
Adjusting the Accept header makes it work as expected.</p>

<p>Otherwise, if there is no <code>format.js</code>, the first responder will be used.</p>

<p>The new Accept value is:</p>
<div class="highlight"><pre>"<span class="o">*/*</span><span class="p">;</span><span class="n">q</span><span class="p">=</span>0<span class="p">.</span>5<span class="p">,</span> <span class="n">text</span><span class="o">/</span><span class="n">javascript</span><span class="p">,</span> <span class="n">application</span><span class="o">/</span><span class="n">javascript</span><span class="p">,</span>
 <span class="n">application</span><span class="o">/</span><span class="n">ecmascript</span><span class="p">,</span> <span class="n">application</span><span class="o">/</span><span class="n">x</span><span class="o">-</span><span class="n">ecmascript</span>"
</pre>
</div>

    
<h2 id="csrf">CSRF</h2>

<p><code>#= require rails/csrf</code></p>

<p>Adds CSRF tokens to AJAX requests and forms missing them.</p>

<p>CSRF tokens must be set in the document head as meta tags.</p>
<div class="highlight"><pre><span class="o">&lt;</span><span class="n">meta</span> <span class="n">name</span><span class="p">=</span>"<span class="n">csrf</span><span class="o">-</span><span class="n">param</span>" <span class="n">content</span><span class="p">=</span>"<span class="n">authenticity_token</span>"<span class="o">&gt;</span>
<span class="o">&lt;</span><span class="n">meta</span> <span class="n">name</span><span class="p">=</span>"<span class="n">csrf</span><span class="o">-</span><span class="n">token</span>" <span class="n">content</span><span class="p">=</span>"5<span class="n">b404f7b7f90dc67708635fc8dd3</span>"<span class="o">&gt;</span>
</pre>
</div>


  </section>


</body></html>